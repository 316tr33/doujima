# フォーム機能テスト手順書

**対象読者:** 開発者
**最終更新:** 2025-11-06

---

## 目次

1. [ローカルテスト](#ローカルテスト)
2. [機能テスト](#機能テスト)
3. [レスポンシブテスト](#レスポンシブテスト)
4. [ブラウザテスト](#ブラウザテスト)
5. [アクセシビリティテスト](#アクセシビリティテスト)
6. [セキュリティテスト](#セキュリティテスト)
7. [パフォーマンステスト](#パフォーマンステスト)
8. [メール送信テスト](#メール送信テスト)

---

## ローカルテスト

### wrangler CLI のインストール

```bash
# Node.jsがインストールされていることを確認
node --version  # v18以上推奨

# wrangler CLIをグローバルインストール
npm install -g wrangler

# バージョン確認
wrangler --version
```

### Cloudflareアカウント認証

```bash
# ブラウザでCloudflareにログイン
wrangler login

# 認証成功メッセージを確認
```

### ローカル開発サーバー起動

```bash
# プロジェクトルートディレクトリに移動
cd /Users/macmiller/Desktop/doujima

# ローカル開発サーバーを起動
wrangler pages dev . --port 8788

# 出力例:
# ⎔ Starting local server...
# ⎔ Listening on http://0.0.0.0:8788
```

### ブラウザでアクセス

**トップページ:**

http://localhost:8788/index.html

**採用ページ:**

http://localhost:8788/recruit.html

**プライバシーポリシー:**

http://localhost:8788/privacy-policy.html

### Pages Functions の動作確認

**ターミナルで確認:**

```bash
# お問い合わせフォームAPI
curl -X POST http://localhost:8788/submit-contact \
  -H "Content-Type: application/json" \
  -d '{"test": true}'

# 期待される応答: {"success": false, "error": "セキュリティ検証が完了していません。"}
```

```bash
# 採用応募フォームAPI
curl -X POST http://localhost:8788/submit-recruit \
  -H "Content-Type: application/json" \
  -d '{"test": true}'

# 期待される応答: {"success": false, "error": "セキュリティ検証が完了していません。"}
```

---

## 機能テスト

### お問い合わせフォーム送信成功

**テスト手順:**

1. http://localhost:8788/index.html にアクセス
2. 「お問い合わせ」ボタンをクリック
3. フォームに以下を入力:

   | フィールド | 入力値 |
   |----------|-------|
   | 会社名 | テスト株式会社 |
   | ご担当者名 | 山田太郎 |
   | メールアドレス | test@example.com |
   | 電話番号 | 090-1234-5678 |
   | ご希望サービス | お遍路事業 |
   | 希望実施日 | 2025-12-01 |
   | 参加予定人数 | 10 |
   | ご要望・詳細 | テストメッセージ |
   | プライバシーポリシー | ✅ チェック |

4. Turnstileウィジェットをクリック（チェックマーク）
5. 「送信する」ボタンをクリック

**期待される結果:**

- [ ] 送信ボタンが無効化される（`aria-busy="true"`）
- [ ] 送信ボタンのテキストが「送信中...」に変わる
- [ ] 3秒以内に成功メッセージが表示される:
  ```
  お問い合わせを受け付けました。担当者より折り返しご連絡いたします。
  ```
- [ ] 3秒後に成功メッセージが自動的に消える
- [ ] フォームがリセットされる（すべてのフィールドが空になる）
- [ ] Turnstileウィジェットがリセットされる

### 採用応募フォーム送信成功

**テスト手順:**

1. http://localhost:8788/recruit.html にアクセス
2. 「採用応募」ボタンをクリック
3. フォームに以下を入力:

   | フィールド | 入力値 |
   |----------|-------|
   | お名前 | 山田太郎 |
   | フリガナ | ヤマダタロウ |
   | メールアドレス | test@example.com |
   | 電話番号 | 090-1234-5678 |
   | 希望職種 | ✅ ツアーガイド、✅ マーケティング |
   | 志望動機 | テスト志望動機 |
   | プライバシーポリシー | ✅ チェック |

4. Turnstileウィジェットをクリック
5. 「応募する」ボタンをクリック

**期待される結果:**

- [ ] 送信ボタンが無効化される
- [ ] 送信ボタンのテキストが「送信中...」に変わる
- [ ] 3秒以内に成功メッセージが表示される:
  ```
  応募を受け付けました。採用担当者より折り返しご連絡いたします。
  ```
- [ ] 3秒後に成功メッセージが自動的に消える
- [ ] フォームがリセットされる

### バリデーションエラー表示（必須項目未入力）

**テスト手順:**

1. お問い合わせフォームで「会社名」を空欄のまま送信

**期待される結果:**

- [ ] エラーメッセージが表示される: `会社名は必須項目です。`
- [ ] エラーメッセージが赤色で表示される
- [ ] 3秒後にエラーメッセージが自動的に消える
- [ ] フォームは送信されない

### メールアドレス形式エラー

**テスト手順:**

1. お問い合わせフォームで「メールアドレス」に `test` と入力（@なし）
2. 送信ボタンをクリック

**期待される結果:**

- [ ] エラーメッセージが表示される: `有効なメールアドレスを入力してください。`
- [ ] フォームは送信されない

### Turnstile検証（サイトキー設定後）

**前提条件:**

- Cloudflare Turnstileのサイトキーが設定されていること
- HTMLに `data-sitekey` が正しく埋め込まれていること

**テスト手順:**

1. お問い合わせフォームですべてのフィールドを入力
2. Turnstileウィジェットをクリック**せずに**送信ボタンをクリック

**期待される結果:**

- [ ] エラーメッセージが表示される: `セキュリティ検証が完了していません。`
- [ ] フォームは送信されない

**正常な流れ:**

1. Turnstileウィジェットをクリック
2. チェックマークが表示される
3. 送信ボタンが有効化される
4. 送信が成功する

### ハニーポット検出（スパム判定）

**テスト手順（開発者用）:**

1. ブラウザの開発者ツール（F12）を開く
2. Consoleタブで以下を実行:

   ```javascript
   // ハニーポット（隠しフィールド）に値を設定
   document.querySelector('input[name="website"]').value = 'spam';
   ```

3. フォームを送信

**期待される結果:**

- [ ] エラーメッセージが表示される: `不正な送信が検出されました。`
- [ ] ステータスコード: 403（Forbidden）
- [ ] フォームは送信されない

### 成功メッセージ表示（3秒後自動非表示）

**テスト手順:**

1. お問い合わせフォームを正常に送信
2. 成功メッセージが表示されたらタイマーで計測

**期待される結果:**

- [ ] 成功メッセージが緑色の背景で表示される
- [ ] メッセージテキスト: `お問い合わせを受け付けました。担当者より折り返しご連絡いたします。`
- [ ] 3秒後（±0.5秒）に自動的にメッセージが消える
- [ ] フェードアウトアニメーション（0.5秒）

### エラーメッセージ表示（3秒後自動非表示）

**テスト手順:**

1. お問い合わせフォームで必須項目を空欄で送信
2. エラーメッセージが表示されたらタイマーで計測

**期待される結果:**

- [ ] エラーメッセージが赤色の背景で表示される
- [ ] 3秒後（±0.5秒）に自動的にメッセージが消える
- [ ] フェードアウトアニメーション（0.5秒）

### フォームリセット（送信成功後）

**テスト手順:**

1. お問い合わせフォームにすべてのフィールドを入力
2. 送信成功
3. フォームの状態を確認

**期待される結果:**

- [ ] すべてのテキストフィールドが空になる
- [ ] セレクトボックスがデフォルト値に戻る
- [ ] チェックボックスがすべて外れる
- [ ] Turnstileウィジェットがリセットされる

### 複数選択（採用フォームの希望職種）

**テスト手順:**

1. 採用応募フォームの「希望職種」で複数を選択
   - ✅ ツアーガイド
   - ✅ マーケティング
2. フォームを送信
3. 受信メールを確認

**期待される結果:**

- [ ] 複数の職種が選択できる
- [ ] 送信が成功する
- [ ] 受信メールに選択した職種がすべて記載される:
  ```
  【希望職種】
  ツアーガイド, マーケティング
  ```

---

## レスポンシブテスト

### デスクトップ（1024px以上）

**テストサイズ:**

- 1920px × 1080px（フルHD）
- 1366px × 768px（一般的なノートPC）
- 1024px × 768px（最小デスクトップサイズ）

**確認項目:**

- [ ] フォームが中央に配置される
- [ ] フィールドの幅が適切（最大600px）
- [ ] ラベルとフィールドが横並び（一部）
- [ ] Turnstileウィジェットが中央に配置される
- [ ] 送信ボタンが中央に配置される

**Chrome DevToolsでテスト:**

1. F12 → Toggle device toolbar（Ctrl+Shift+M）
2. Responsive を選択
3. 幅を1920px、1366px、1024pxに変更して確認

### タブレット（768px）

**テストサイズ:**

- 768px × 1024px（iPad縦向き）
- 1024px × 768px（iPad横向き）

**確認項目:**

- [ ] フォームの幅が画面の80%
- [ ] フィールドが縦に並ぶ
- [ ] フォントサイズが適切（16px以上）
- [ ] タッチターゲットが44px以上（ボタン、チェックボックス）
- [ ] Turnstileウィジェットが中央に配置される

**Safari（iPad）でテスト:**

- 実機またはシミュレーターで確認

### モバイル（480px）

**テストサイズ:**

- 480px × 800px（一般的なスマートフォン）
- 375px × 667px（iPhone SE）
- 360px × 640px（Galaxy S8+）

**確認項目:**

- [ ] フォームの幅が画面の95%
- [ ] フィールドが縦に並ぶ
- [ ] フォントサイズが16px以上（iOS のズーム防止）
- [ ] 入力フィールドの高さが44px以上
- [ ] 送信ボタンの高さが48px以上
- [ ] パディングが適切（画面端から16px以上）
- [ ] Turnstileウィジェットがコンパクトモード

**モバイルSafari（iPhone）でテスト:**

- 実機で確認（必須）

### モバイル（375px - iPhone SE）

**重要:** CSS設計の基準サイズ

**確認項目:**

- [ ] すべてのコンテンツが横スクロールなしで表示される
- [ ] テキストが読みやすい（16px以上）
- [ ] ボタンがタップしやすい（48px × 48px以上）
- [ ] フォームフィールドが画面幅に収まる

### モバイル（360px - Galaxy S8+）

**重要:** 最終防衛ライン

**確認項目:**

- [ ] すべてのコンテンツが表示される
- [ ] 横スクロールが発生しない
- [ ] テキストが小さすぎない
- [ ] ボタンが重ならない

**Chrome DevToolsでテスト:**

1. F12 → Toggle device toolbar
2. Galaxy S8+ を選択
3. フォームを操作して確認

---

## ブラウザテスト

### Chrome（最新版）

**バージョン確認:**

```
chrome://settings/help
```

**確認項目:**

- [ ] フォームが正常に表示される
- [ ] JavaScriptが正常に動作する
- [ ] Turnstileウィジェットが表示される
- [ ] フォーム送信が成功する
- [ ] エラーメッセージが表示される
- [ ] 成功メッセージが表示される

### Firefox（最新版）

**バージョン確認:**

```
about:support
```

**確認項目:**

- [ ] フォームが正常に表示される
- [ ] CSSのレイアウトがChromeと一致する
- [ ] JavaScriptが正常に動作する
- [ ] Turnstileウィジェットが表示される
- [ ] フォーム送信が成功する

### Safari（最新版）

**バージョン確認:**

```
Safari → About Safari
```

**確認項目:**

- [ ] フォームが正常に表示される
- [ ] `-webkit-` プレフィックスが正しく適用される
- [ ] フォントレンダリングが適切
- [ ] JavaScriptが正常に動作する
- [ ] Turnstileウィジェットが表示される
- [ ] フォーム送信が成功する

### Edge（最新版）

**バージョン確認:**

```
edge://settings/help
```

**確認項目:**

- [ ] フォームが正常に表示される
- [ ] Chromeと同じレンダリング
- [ ] JavaScriptが正常に動作する
- [ ] Turnstileウィジェットが表示される
- [ ] フォーム送信が成功する

### モバイルSafari（iOS）

**テストデバイス:**

- iPhone 12 Pro以降推奨
- iOS 15以降

**確認項目:**

- [ ] フォームフィールドをタップすると適切にフォーカスする
- [ ] キーボードが表示されてもフォームが見える
- [ ] `autocomplete` が正しく機能する
- [ ] フォント自動拡大が発生しない（16px以上）
- [ ] Turnstileウィジェットがタッチ操作で動作する
- [ ] フォーム送信が成功する

### モバイルChrome（Android）

**テストデバイス:**

- Pixel 4以降推奨
- Android 10以降

**確認項目:**

- [ ] フォームが正常に表示される
- [ ] タッチ操作が正常に動作する
- [ ] キーボードが適切に表示される
- [ ] Turnstileウィジェットが動作する
- [ ] フォーム送信が成功する

---

## アクセシビリティテスト

### キーボード操作

**テスト手順:**

1. マウスを使わずにキーボードのみでフォームを操作

**確認項目:**

- [ ] **Tab** キーで次のフィールドに移動できる
- [ ] **Shift+Tab** キーで前のフィールドに移動できる
- [ ] フォーカスが視覚的に分かる（アウトライン表示）
- [ ] **Enter** キーでフォームを送信できる
- [ ] **Space** キーでチェックボックスを切り替えられる
- [ ] **矢印キー** でセレクトボックスを操作できる
- [ ] タブ順序が論理的（上から下、左から右）

### スクリーンリーダー（VoiceOver - Mac）

**起動方法:**

```
Command + F5
```

**テスト手順:**

1. VoiceOverを起動
2. お問い合わせフォームにアクセス
3. Tab キーでフォームを操作

**確認項目:**

- [ ] フィールドのラベルが読み上げられる
- [ ] 必須項目が「必須」と読み上げられる
- [ ] プレースホルダーが読み上げられる
- [ ] エラーメッセージが読み上げられる
- [ ] 成功メッセージが読み上げられる
- [ ] 送信ボタンの状態（有効/無効）が読み上げられる

**期待される読み上げ例:**

```
会社名、必須、編集中、テキストフィールド
```

### スクリーンリーダー（NVDA - Windows）

**ダウンロード:**

https://www.nvaccess.org/download/

**テスト手順:**

1. NVDAを起動（Ctrl+Alt+N）
2. お問い合わせフォームにアクセス
3. Tab キーでフォームを操作

**確認項目:**

- [ ] フィールドのラベルが読み上げられる
- [ ] 必須項目が「必須」と読み上げられる
- [ ] エラーメッセージが適切に読み上げられる
- [ ] `aria-describedby` が正しく機能する

### aria-busy（送信中）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Elements タブで送信ボタンを選択
3. フォームを送信

**確認項目:**

- [ ] 送信ボタンに `aria-busy="true"` が設定される
- [ ] スクリーンリーダーが「送信中」と読み上げる
- [ ] 送信完了後、`aria-busy="false"` に戻る

### role="alert"（エラーメッセージ）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Elements タブでエラーメッセージ要素を選択
3. 必須項目未入力で送信

**確認項目:**

- [ ] エラーメッセージ要素に `role="alert"` が設定されている
- [ ] スクリーンリーダーが即座にエラーメッセージを読み上げる
- [ ] `aria-live="assertive"` が設定されている

### aria-hidden（ハニーポット）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Elements タブでハニーポット（`name="website"`）を検索

**確認項目:**

- [ ] ハニーポットに `aria-hidden="true"` が設定されている
- [ ] スクリーンリーダーがハニーポットを読み上げない
- [ ] タブキーでハニーポットにフォーカスが移動しない

---

## セキュリティテスト

### Turnstile検証（ボット判定）

**テスト手順（開発者用）:**

1. ブラウザの開発者ツール（F12）を開く
2. Consoleタブで以下を実行:

   ```javascript
   // Turnstileトークンなしで送信を試みる
   fetch('/submit-contact', {
     method: 'POST',
     headers: { 'Content-Type': 'application/json' },
     body: JSON.stringify({
       company: 'Test',
       name: 'Test',
       email: 'test@example.com',
       service: 'お遍路事業',
       privacy: true,
       // cf-turnstile-response なし
     })
   }).then(r => r.json()).then(console.log);
   ```

**期待される結果:**

- [ ] ステータスコード: 400（Bad Request）
- [ ] エラーメッセージ: `セキュリティ検証が完了していません。`

### ハニーポット検出（スパム判定）

**テスト手順（開発者用）:**

```javascript
// ハニーポットに値を設定して送信
fetch('/submit-contact', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    company: 'Test',
    name: 'Test',
    email: 'test@example.com',
    service: 'お遍路事業',
    privacy: true,
    website: 'https://spam.com', // ハニーポット
    'cf-turnstile-response': 'dummy-token'
  })
}).then(r => r.json()).then(console.log);
```

**期待される結果:**

- [ ] ステータスコード: 403（Forbidden）
- [ ] エラーメッセージ: `不正な送信が検出されました。`

### レート制限（5分間に3回送信試行）

**テスト手順:**

1. お問い合わせフォームを3回連続で送信（すべて成功）
2. 4回目の送信を試みる

**期待される結果:**

- [ ] 1回目: 送信成功
- [ ] 2回目: 送信成功
- [ ] 3回目: 送信成功
- [ ] 4回目: ステータスコード 429（Too Many Requests）
- [ ] エラーメッセージ: `送信回数が制限を超えました。しばらく時間をおいて再度お試しください。`
- [ ] `Retry-After` ヘッダー: `300`（秒）

**5分後の確認:**

- [ ] 5分待機
- [ ] 再度送信を試みる
- [ ] 送信が成功する（レート制限がリセットされる）

### XSS対策（`<script>`タグ入力）

**テスト手順:**

1. お問い合わせフォームの「ご要望・詳細」に以下を入力:

   ```html
   <script>alert('XSS攻撃')</script>
   ```

2. フォームを送信
3. 受信メールを確認

**期待される結果:**

- [ ] フォーム送信が成功する（ブロックされない）
- [ ] 受信メールにそのまま表示される（サニタイズされない）
- [ ] **重要:** HTMLメールではなくテキストメールなので、スクリプトは実行されない

**セキュリティ対策:**

- メール本文はプレーンテキスト（`text/plain`）で送信
- HTMLメールは使用しない
- ブラウザでスクリプトが実行されることはない

### SQLインジェクション対策（`' OR '1'='1`入力）

**テスト手順:**

1. お問い合わせフォームの「会社名」に以下を入力:

   ```sql
   ' OR '1'='1
   ```

2. フォームを送信
3. 受信メールを確認

**期待される結果:**

- [ ] フォーム送信が成功する
- [ ] 受信メールにそのまま表示される
- [ ] **重要:** このプロジェクトはデータベースを使用しないため、SQLインジェクションのリスクはない

**セキュリティ対策:**

- データベース未使用
- メールで送信するのみ
- 将来的にデータベース導入時は、プリペアドステートメント使用必須

---

## パフォーマンステスト

### ページ読み込み速度（3秒以内）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Network タブを選択
3. キャッシュをクリア（Disable cache にチェック）
4. ページをリロード（Ctrl+R）
5. DOMContentLoaded と Load の時間を確認

**期待される結果:**

- [ ] DOMContentLoaded: 1秒以内
- [ ] Load: 3秒以内
- [ ] ページが使用可能になるまで: 2秒以内

**Chrome DevToolsで計測:**

```
DOMContentLoaded: 800ms
Load: 2.5s
```

### フォーム送信レスポンス（1秒以内）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Network タブを選択
3. お問い合わせフォームを送信
4. `submit-contact` リクエストの Time を確認

**期待される結果:**

- [ ] レスポンス時間: 1秒以内
- [ ] ステータスコード: 200（成功時）

**Chrome DevToolsで計測:**

```
submit-contact
Status: 200
Time: 800ms
```

### Turnstile読み込み（非同期）

**テスト手順:**

1. ブラウザの開発者ツール（F12）を開く
2. Network タブを選択
3. ページをリロード
4. `turnstile` スクリプトの読み込みを確認

**期待される結果:**

- [ ] Turnstileスクリプトが非同期で読み込まれる（`async defer`）
- [ ] ページの初期表示をブロックしない
- [ ] Turnstileウィジェットが1〜2秒以内に表示される

---

## メール送信テスト

### お問い合わせメール受信確認

**テスト手順:**

1. お問い合わせフォームに以下を入力:

   | フィールド | 入力値 |
   |----------|-------|
   | 会社名 | テスト株式会社 |
   | ご担当者名 | 山田太郎 |
   | メールアドレス | test@example.com |
   | 電話番号 | 090-1234-5678 |
   | ご希望サービス | お遍路事業 |
   | 希望実施日 | 2025-12-01 |
   | 参加予定人数 | 10 |
   | ご要望・詳細 | テストメッセージです。 |

2. フォームを送信
3. 受信先メールアドレス（`info@doujimafront.com`）でメール受信を確認

**期待される結果:**

- [ ] メールが1分以内に受信される
- [ ] 件名が正しい: `【お問い合わせ】テスト株式会社 - お遍路事業`
- [ ] 送信元が正しい: `堂島フロント企画 お問い合わせフォーム <noreply@doujimafront.com>`
- [ ] メール本文が以下のフォーマットで表示される

**メール本文フォーマット:**

```
堂島フロント企画 お問い合わせフォームより新しいお問い合わせがありました。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ お問い合わせ内容
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【会社名】
テスト株式会社

【ご担当者名】
山田太郎

【メールアドレス】
test@example.com

【電話番号】
090-1234-5678

【ご希望サービス】
お遍路事業

【希望実施日】
2025-12-01

【参加予定人数】
10名

【ご要望・詳細】
テストメッセージです。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
送信日時: 2025/11/06 23:45:30
送信元IP: 123.456.789.10
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

このメールは堂島フロント企画の自動送信システムより送信されています。
```

### 採用応募メール受信確認

**テスト手順:**

1. 採用応募フォームに以下を入力:

   | フィールド | 入力値 |
   |----------|-------|
   | お名前 | 山田太郎 |
   | フリガナ | ヤマダタロウ |
   | メールアドレス | test@example.com |
   | 電話番号 | 090-1234-5678 |
   | 希望職種 | ✅ ツアーガイド、✅ マーケティング |
   | 志望動機 | テスト志望動機です。 |

2. フォームを送信
3. 受信先メールアドレスでメール受信を確認

**期待される結果:**

- [ ] メールが1分以内に受信される
- [ ] 件名が正しい: `【採用応募】山田太郎 - ツアーガイド, マーケティング`
- [ ] 送信元が正しい: `堂島フロント企画 採用応募フォーム <noreply@doujimafront.com>`
- [ ] メール本文が正しいフォーマットで表示される

### メール本文フォーマット確認

**確認項目:**

- [ ] 件名が正しい
- [ ] 送信元名が正しい
- [ ] 罫線（━）が正しく表示される
- [ ] セクション分けが見やすい
- [ ] 日本語が文字化けしていない
- [ ] タイムスタンプが日本時間（JST）で表示される
- [ ] 送信元IPアドレスが記載されている

### 日本語エンコーディング確認

**確認項目:**

- [ ] 件名の日本語が正しく表示される
- [ ] メール本文の日本語が正しく表示される
- [ ] 特殊文字（「」、・、〜等）が正しく表示される
- [ ] 罫線（━）が正しく表示される

**文字化け例（NG）:**

```
ãƒ†ã‚¹ãƒˆæ ªå¼ä¼šç¤¾
```

**正しい表示（OK）:**

```
テスト株式会社
```

### 送信元アドレス確認（noreply@doujimafront.com）

**確認項目:**

- [ ] 送信元アドレスが `noreply@doujimafront.com`
- [ ] 送信元名が `堂島フロント企画 お問い合わせフォーム`（お問い合わせ）
- [ ] 送信元名が `堂島フロント企画 採用応募フォーム`（採用応募）
- [ ] `noreply` アドレスに返信できない旨が明記されている（推奨）

---

## テスト完了チェックリスト

### ローカルテスト

- [ ] wrangler CLI インストール
- [ ] ローカル開発サーバー起動成功
- [ ] Pages Functions 動作確認

### 機能テスト

- [ ] お問い合わせフォーム送信成功
- [ ] 採用応募フォーム送信成功
- [ ] バリデーションエラー表示
- [ ] メールアドレス形式エラー
- [ ] Turnstile検証
- [ ] ハニーポット検出
- [ ] 成功メッセージ表示（3秒後自動非表示）
- [ ] エラーメッセージ表示（3秒後自動非表示）
- [ ] フォームリセット
- [ ] 複数選択（希望職種）

### レスポンシブテスト

- [ ] デスクトップ（1024px以上）
- [ ] タブレット（768px）
- [ ] モバイル（480px）
- [ ] モバイル（375px - iPhone SE）
- [ ] モバイル（360px - Galaxy S8+）

### ブラウザテスト

- [ ] Chrome（最新版）
- [ ] Firefox（最新版）
- [ ] Safari（最新版）
- [ ] Edge（最新版）
- [ ] モバイルSafari（iOS）
- [ ] モバイルChrome（Android）

### アクセシビリティテスト

- [ ] キーボード操作（Tab、Enter）
- [ ] スクリーンリーダー（VoiceOver）
- [ ] スクリーンリーダー（NVDA）
- [ ] aria-busy（送信中）
- [ ] role="alert"（エラーメッセージ）
- [ ] aria-hidden（ハニーポット）

### セキュリティテスト

- [ ] Turnstile検証（ボット判定）
- [ ] ハニーポット検出（スパム判定）
- [ ] レート制限（5分間に3回）
- [ ] XSS対策（`<script>`タグ入力）
- [ ] SQLインジェクション対策（`' OR '1'='1`入力）

### パフォーマンステスト

- [ ] ページ読み込み速度（3秒以内）
- [ ] フォーム送信レスポンス（1秒以内）
- [ ] Turnstile読み込み（非同期）

### メール送信テスト

- [ ] お問い合わせメール受信確認
- [ ] 採用応募メール受信確認
- [ ] メール本文フォーマット確認
- [ ] 日本語エンコーディング確認
- [ ] 送信元アドレス確認

---

## トラブルシューティング

### テストが失敗した場合

**ローカルテストの失敗:**

- wrangler のバージョンを確認（最新版にアップデート）
- `wrangler.toml` の設定を確認
- 環境変数が正しく設定されているか確認

**機能テストの失敗:**

- ブラウザのコンソールでエラーを確認
- Network タブでリクエスト/レスポンスを確認
- Pages Functions のログを確認（Cloudflare Dashboard）

**メール送信テストの失敗:**

- 環境変数 `RECIPIENT_EMAIL` を確認
- 環境変数 `FROM_EMAIL` を確認
- MailChannels API のログを確認
- スパムフォルダを確認

---

## サポート情報

### 公式ドキュメント

- **Cloudflare Pages Functions:** https://developers.cloudflare.com/pages/functions/
- **MailChannels API:** https://mailchannels.zendesk.com/hc/en-us/articles/4565898358413
- **Cloudflare Turnstile:** https://developers.cloudflare.com/turnstile/
- **Workers KV:** https://developers.cloudflare.com/kv/

### 問題報告

プロジェクト固有の問題は開発チームに連絡してください。
